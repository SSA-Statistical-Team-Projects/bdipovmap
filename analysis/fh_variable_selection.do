use "C:\Users\wb559885\OneDrive - WBG\Documents\GitProjects\bdipovmap\data-clean\commune_data.dta", replace

global candidates targetave_ntl_all_2015 targetave_ntl_all_2016 targetave_ntl_all_2017 targetave_ntl_all_2018 targetave_ntl_all_2019 targetave_ntl_all_2020 targetave_ntl_built_up_2015 targetave_ntl_built_up_2016 targetave_ntl_built_up_2017 targetave_ntl_built_up_2018 targetave_ntl_built_up_2019 targetave_ntl_built_up_2020 targetave_ntl_small_stl_2015 targetave_ntl_small_stl_2016 targetave_ntl_small_stl_2017 targetave_ntl_small_stl_2018 targetave_ntl_small_stl_2019 targetave_ntl_small_stl_2020 targetave_ntl_hamlet_2015 targetave_ntl_hamlet_2016 targetave_ntl_hamlet_2017 targetave_ntl_hamlet_2018 targetave_ntl_hamlet_2019 targetave_ntl_hamlet_2020 targetave_pop_density_2015 targetave_pop_density_2016 targetave_pop_density_2017 targetave_pop_density_2018 targetave_pop_density_2019 targetave_pop_density_2020 targetave_lightscore_sy_2012 targetave_prplit_conf90_sy_2012 targetave_lightscore_sy_2019 targetave_prplit_conf90_sy_2019 targetave_2017_Water targetave_2017_Trees targetave_2017_fld_veg targetave_2017_Crops targetave_2017_Built_Area targetave_2017_Bare_ground targetave_2017_Snow_Ice targetave_2017_Clouds targetave_2017_Rangeland targetave_2018_Water targetave_2018_Trees targetave_2018_fld_veg targetave_2018_Crops targetave_2018_Built_Area targetave_2018_Bare_ground targetave_2018_Snow_Ice targetave_2018_Clouds targetave_2018_Rangeland targetave_2019_Water targetave_2019_Trees targetave_2019_fld_veg targetave_2019_Crops targetave_2019_Built_Area targetave_2019_Bare_ground targetave_2019_Snow_Ice targetave_2019_Clouds targetave_2019_Rangeland targetave_2020_Water targetave_2020_Trees targetave_2020_fld_veg targetave_2020_Crops targetave_2020_Built_Area targetave_2020_Bare_ground targetave_2020_Snow_Ice targetave_2020_Clouds targetave_2020_Rangeland targetave_building_sum targetave_building_density targetave_building_mean_area targetave_building_mean_length targetave_building_mean_urban targetave_building_mean_year targetave_pdsi_mean2018 targetave_aet_mean2018 targetave_def_mean2018 targetave_pr_mean2018 targetave_ro_mean2018 targetave_soil_mean2018 targetave_tmmn_mean2018 targetave_tmmx_mean2018 targetave_swe_mean2018 targetave_srad_mean2018 targetave_pdsi_mean2014 targetave_aet_mean2014 targetave_def_mean2014 targetave_pr_mean2014 targetave_ro_mean2014 targetave_soil_mean2014 targetave_tmmn_mean2014 targetave_tmmx_mean2014 targetave_swe_mean2014 targetave_srad_mean2014 targetave_pdsi_mean2009 targetave_aet_mean2009 targetave_def_mean2009 targetave_pr_mean2009 targetave_ro_mean2009 targetave_soil_mean2009 targetave_tmmn_mean2009 targetave_tmmx_mean2009 targetave_swe_mean2009 targetave_srad_mean2009 targetave_pdsi_mean99_19 targetave_aet_mean99_19 targetave_def_mean99_19 targetave_pr_mean99_19 targetave_ro_mean99_19 targetave_soil_mean99_19 targetave_tmmn_mean99_19 targetave_tmmx_mean99_19 targetave_swe_mean99_19 targetave_srad_mean99_19 targetave_pdsi_change_5 targetave_aet_change_5 targetave_def_change_5 targetave_pr_change_5 targetave_ro_change_5 targetave_soil_change_5 targetave_tmmn_change_5 targetave_tmmx_change_5 targetave_srad_change_5 targetave_pdsi_change_10 targetave_aet_change_10 targetave_def_change_10 targetave_pr_change_10 targetave_ro_change_10 targetave_soil_change_10 targetave_tmmn_change_10 targetave_tmmx_change_10  targetave_srad_change_10 targetave_pdsi_hist_dev targetave_aet_hist_dev targetave_def_hist_dev targetave_pr_hist_dev targetave_ro_hist_dev targetave_soil_hist_dev targetave_tmmn_hist_dev targetave_tmmx_hist_dev targetave_srad_hist_dev targetave_pdsi_sq_hist_dev targetave_aet_sq_hist_dev targetave_def_sq_hist_dev targetave_pr_sq_hist_dev targetave_ro_sq_hist_dev targetave_soil_sq_hist_dev targetave_tmmn_sq_hist_dev targetave_tmmx_sq_hist_dev targetave_srad_sq_hist_dev targetave_meta_wealth_index targetave_BU2016DHS_ANANEMWANY targetave_BU2016DHS_CHVAC1CVCD targetave_BU2016DHS_CHVACCCBAS targetave_BU2016DHS_CHVACCCDP1 targetave_BU2016DHS_CHVACCCDP3 targetave_BU2016DHS_CHVACSCMSL targetave_BU2016DHS_CNNUTSCHA2 targetave_BU2016DHS_EDLITRMLIT targetave_BU2016DHS_EDLITRWLIT targetave_BU2016DHS_FPCUSMWMOD targetave_BU2016DHS_FPNADMWPDM targetave_BU2016DHS_FPNADMWUNT targetave_BU2016DHS_MLITNAPACC targetave_BU2016DHS_RHANCNWN4P targetave_BU2016DHS_RHDELPCDHF targetave_BU2016DHS_WSSRCEPIMP targetave_BU2016DHS_WSTLETPNFC targetave_normal_ntl_mean2015 targetave_normal_ntl_mean2016 targetave_normal_ntl_mean2017 targetave_normal_ntl_mean2018 targetave_normal_ntl_mean2019 targetave_normal_ntl_mean2020 BDI001 BDI002 BDI003 BDI004 BDI005 BDI006 BDI007 BDI008 BDI009 BDI010 BDI011 BDI012 BDI013 BDI014 BDI015 BDI016 BDI017 BDI018

lasso linear Direct "$candidates" [iw = population], selection(bic, postsel) cluster(admin1Pcod)

global selection = e(allvars_sel)
putexcel set "C:\Users\wb559885\OneDrive - WBG\Documents\GitProjects\bdipovmap\data-clean\model_selection\selected_variables_fh_admin1.csv", modify
putexcel A1 = "$selection"
